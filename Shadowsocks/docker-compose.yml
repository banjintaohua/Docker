version: "3.9"

services:
  ss-websocket-http:
    image: teddysun/shadowsocks-libev:${SHADOWSOCKS_VERSION:-3.3.5}
    container_name: ss-websocket-http
    command: "ss-server -c /etc/shadowsocks-libev/config.json > /var/log/ss-websocket-http.log 2>&1"
    working_dir: /etc/shadowsocks-libev
    networks:
      - vpn
    restart: always
    ports:
      - "40004:9100"
      - "40004:9100/udp"
    volumes:
      - ./conf/ss-websocket-http:/etc/shadowsocks-libev:rw
      - ./log/ss-websocket-http:/var/log/shadowsocks

  ss-websocket-https:
    image: teddysun/shadowsocks-libev:${SHADOWSOCKS_VERSION:-3.3.5}
    container_name: ss-websocket-https
    command: "ss-server -c /etc/shadowsocks-libev/config.json > /var/log/ss-websocket-https 2>&1"
    working_dir: /etc/shadowsocks-libev
    networks:
      - vpn
    restart: always
    ports:
      - "40005:9100"
      - "40005:9100/udp"
    volumes:
      - ../Nginx/conf/ssl:/etc/ssl:ro
      - ./conf/ss-websocket-https:/etc/shadowsocks-libev:rw
      - ./log/ss-websocket-https:/var/log/shadowsocks

networks:
  vpn:
    name: develop
    external: false
    driver: bridge